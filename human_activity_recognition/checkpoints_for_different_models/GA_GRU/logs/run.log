------------ run folder /home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-16-38-19-960375 ------------
------------ Preparing dataset hapt... -----------
Model: "sequence_GRU_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 250, 6)]          0         
                                                                 
 gru (GRU)                   (None, 250, 256)          202752    
                                                                 
 batch_normalization (BatchN  (None, 250, 256)         1024      
 ormalization)                                                   
                                                                 
 activation (Activation)     (None, 250, 256)          0         
                                                                 
 dense (Dense)               (None, 250, 128)          32896     
                                                                 
 batch_normalization_1 (Batc  (None, 250, 128)         512       
 hNormalization)                                                 
                                                                 
 activation_1 (Activation)   (None, 250, 128)          0         
                                                                 
 dropout (Dropout)           (None, 250, 128)          0         
                                                                 
 gru_1 (GRU)                 (None, 250, 128)          99072     
                                                                 
 batch_normalization_2 (Batc  (None, 250, 128)         512       
 hNormalization)                                                 
                                                                 
 activation_2 (Activation)   (None, 250, 128)          0         
                                                                 
 dense_1 (Dense)             (None, 250, 64)           8256      
                                                                 
 batch_normalization_3 (Batc  (None, 250, 64)          256       
 hNormalization)                                                 
                                                                 
 activation_3 (Activation)   (None, 250, 64)           0         
                                                                 
 dropout_1 (Dropout)         (None, 250, 64)           0         
                                                                 
 gru_2 (GRU)                 (None, 250, 64)           24960     
                                                                 
 batch_normalization_4 (Batc  (None, 250, 64)          256       
 hNormalization)                                                 
                                                                 
 activation_4 (Activation)   (None, 250, 64)           0         
                                                                 
 global_average_pooling1d (G  (None, 64)               0         
 lobalAveragePooling1D)                                          
                                                                 
 dense_2 (Dense)             (None, 32)                2080      
                                                                 
 batch_normalization_5 (Batc  (None, 32)               128       
 hNormalization)                                                 
                                                                 
 activation_5 (Activation)   (None, 32)                0         
                                                                 
 dropout_2 (Dropout)         (None, 32)                0         
                                                                 
 dense_3 (Dense)             (None, 6)                 198       
                                                                 
=================================================================
Total params: 372,902
Trainable params: 371,558
Non-trainable params: 1,344
_________________________________________________________________
------------ Train and evaluate ------------

------------ Starting training ----------
initializing from scratch.

Step 100, train_loss: 0.6777234673500061, train_accuracy: 79.14239501953125, val_loss: 1.1923229694366455, val_accuracy: 66.52977752685547, confusion_matrix:
[[29. 10.  0.  0. 25. 22.]
 [ 0. 65.  0.  0.  1.  0.]
 [ 0.  0. 54.  0.  3.  0.]
 [ 0.  0.  0.  0. 23. 65.]
 [ 0.  0.  1.  0. 77. 13.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 100: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-16-38-19-960375/ckpts/train/ckpt-1.
Step 200, train_loss: 0.3143543303012848, train_accuracy: 93.0582504272461, val_loss: 0.5867823362350464, val_accuracy: 92.81314086914062, confusion_matrix:
[[81.  3.  0.  0.  2.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  1. 55.  0.  0.  0.]
 [ 0.  0.  0. 61. 27.  0.]
 [ 0.  0.  0.  1. 90.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 200: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-16-38-19-960375/ckpts/train/ckpt-2.
Step 300, train_loss: 0.2523311674594879, train_accuracy: 94.67693328857422, val_loss: 0.37929368019104004, val_accuracy: 91.78645324707031, confusion_matrix:
[[84.  2.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  1. 55.  0.  0.  0.]
 [ 0.  0.  0. 52. 36.  0.]
 [ 0.  0.  0.  0. 91.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 400, train_loss: 0.21908098459243774, train_accuracy: 95.06068420410156, val_loss: 0.3972657322883606, val_accuracy: 89.52771759033203, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 57. 31.  0.]
 [ 0.  0.  0. 17. 74.  0.]
 [ 0.  1.  0.  0.  0. 98.]]
Step 500, train_loss: 0.1994793713092804, train_accuracy: 95.49352264404297, val_loss: 0.43482017517089844, val_accuracy: 86.24230194091797, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 64. 24.  0.]
 [ 0.  0.  0. 34. 57.  0.]
 [ 0.  7.  0.  0.  0. 92.]]
Step 600, train_loss: 0.180318683385849, train_accuracy: 95.74234771728516, val_loss: 0.422651469707489, val_accuracy: 89.52771759033203, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 64. 24.  0.]
 [ 0.  0.  0. 26. 65.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 700, train_loss: 0.16394664347171783, train_accuracy: 96.01537322998047, val_loss: 0.40448200702667236, val_accuracy: 90.75975036621094, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 19. 72.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 800, train_loss: 0.1577555537223816, train_accuracy: 96.0396499633789, val_loss: 0.4062197506427765, val_accuracy: 89.52771759033203, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 25. 66.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 900, train_loss: 0.14618299901485443, train_accuracy: 96.37026977539062, val_loss: 0.41772252321243286, val_accuracy: 89.52771759033203, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 25. 66.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1000, train_loss: 0.13586317002773285, train_accuracy: 96.55339813232422, val_loss: 0.41555413603782654, val_accuracy: 89.7330551147461, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 32. 59.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1100, train_loss: 0.1297168880701065, train_accuracy: 96.72734832763672, val_loss: 0.46608054637908936, val_accuracy: 89.52771759033203, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 33. 58.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1200, train_loss: 0.12233789265155792, train_accuracy: 96.94551086425781, val_loss: 0.4805806279182434, val_accuracy: 89.32238006591797, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 33. 58.  0.]
 [ 0.  1.  0.  0.  0. 98.]]
Step 1300, train_loss: 0.11701193451881409, train_accuracy: 96.91343688964844, val_loss: 0.45165127515792847, val_accuracy: 89.7330551147461, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 32. 59.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1400, train_loss: 0.1151784360408783, train_accuracy: 96.95793151855469, val_loss: 0.42153897881507874, val_accuracy: 89.7330551147461, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 32. 59.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1500, train_loss: 0.10381779819726944, train_accuracy: 97.30200958251953, val_loss: 0.44791680574417114, val_accuracy: 88.29568481445312, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 32. 59.  0.]
 [ 0.  7.  0.  0.  0. 92.]]
Step 1600, train_loss: 0.09967933595180511, train_accuracy: 97.48381805419922, val_loss: 0.40910112857818604, val_accuracy: 90.34907531738281, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 29. 62.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1700, train_loss: 0.09213782101869583, train_accuracy: 97.60922241210938, val_loss: 0.3861638307571411, val_accuracy: 90.55441284179688, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 21. 70.  0.]
 [ 0.  7.  0.  0.  0. 92.]]
Step 1800, train_loss: 0.08842874318361282, train_accuracy: 97.74356842041016, val_loss: 0.38531970977783203, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 24. 67.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1900, train_loss: 0.08701170235872269, train_accuracy: 97.66585540771484, val_loss: 0.4122530221939087, val_accuracy: 90.96509552001953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 26. 65.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2000, train_loss: 0.0801013857126236, train_accuracy: 97.89239501953125, val_loss: 0.378765732049942, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 24. 67.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2100, train_loss: 0.07595330476760864, train_accuracy: 98.0635986328125, val_loss: 0.34951964020729065, val_accuracy: 90.75975036621094, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0. 19. 72.  0.]
 [ 0.  7.  0.  0.  0. 92.]]
Step 2200, train_loss: 0.08599217236042023, train_accuracy: 97.57686614990234, val_loss: 0.45238035917282104, val_accuracy: 90.34907531738281, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 29. 62.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2300, train_loss: 0.07452994585037231, train_accuracy: 98.03398132324219, val_loss: 0.3723531663417816, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 23. 68.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2400, train_loss: 0.06534212827682495, train_accuracy: 98.3026123046875, val_loss: 0.4200049340724945, val_accuracy: 89.7330551147461, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 25. 66.  0.]
 [ 0.  7.  0.  0.  0. 92.]]
Step 2500, train_loss: 0.06720641255378723, train_accuracy: 98.2847900390625, val_loss: 0.3652343153953552, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 23. 68.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2600, train_loss: 0.06066964939236641, train_accuracy: 98.48705291748047, val_loss: 0.347933292388916, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 23. 68.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2700, train_loss: 0.06393954157829285, train_accuracy: 98.31881713867188, val_loss: 0.32041266560554504, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 64. 24.  0.]
 [ 0.  0.  0.  1. 90.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 2700: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-16-38-19-960375/ckpts/train/ckpt-3.
Step 2800, train_loss: 0.06097719073295593, train_accuracy: 98.36974334716797, val_loss: 0.394167959690094, val_accuracy: 91.1704330444336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 25. 66.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2900, train_loss: 0.05793291702866554, train_accuracy: 98.49110412597656, val_loss: 0.367476224899292, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 23. 68.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3000, train_loss: 0.06018463149666786, train_accuracy: 98.29045867919922, val_loss: 0.3688633143901825, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 24. 67.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3100, train_loss: 0.05073443427681923, train_accuracy: 98.6326904296875, val_loss: 0.35968515276908875, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 23. 68.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3200, train_loss: 0.04875022917985916, train_accuracy: 98.75, val_loss: 0.26426100730895996, val_accuracy: 95.27720642089844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 3200: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-16-38-19-960375/ckpts/train/ckpt-4.
Step 3300, train_loss: 0.061241280287504196, train_accuracy: 98.23779296875, val_loss: 0.30005961656570435, val_accuracy: 94.2505111694336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3400, train_loss: 0.044909216463565826, train_accuracy: 98.79045104980469, val_loss: 0.2918662428855896, val_accuracy: 92.60780334472656, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 18. 73.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3500, train_loss: 0.04840667545795441, train_accuracy: 98.68931579589844, val_loss: 0.3257989287376404, val_accuracy: 93.01847839355469, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 16. 75.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3600, train_loss: 0.047019850462675095, train_accuracy: 98.77252960205078, val_loss: 0.3167688846588135, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3700, train_loss: 0.04584379494190216, train_accuracy: 98.70549774169922, val_loss: 0.3523481786251068, val_accuracy: 93.42916107177734, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 12. 79.  0.]
 [ 0.  0.  0.  0.  2. 97.]]
Step 3800, train_loss: 0.04010443761944771, train_accuracy: 98.96844482421875, val_loss: 0.3058278262615204, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 3900, train_loss: 0.040164221078157425, train_accuracy: 98.91837310791016, val_loss: 0.28805896639823914, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4000, train_loss: 0.03798054903745651, train_accuracy: 99.01294708251953, val_loss: 0.30034592747688293, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 15. 76.  0.]
 [ 0.  5.  0.  0.  0. 94.]]
Step 4100, train_loss: 0.04153792932629585, train_accuracy: 98.79449462890625, val_loss: 0.32521170377731323, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4200, train_loss: 0.04088754206895828, train_accuracy: 98.79279327392578, val_loss: 0.31098514795303345, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4300, train_loss: 0.03351917117834091, train_accuracy: 99.10598754882812, val_loss: 0.287200927734375, val_accuracy: 94.86653137207031, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4400, train_loss: 0.03728915750980377, train_accuracy: 99.00890350341797, val_loss: 0.33169877529144287, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4500, train_loss: 0.0359673798084259, train_accuracy: 99.01964569091797, val_loss: 0.30656465888023376, val_accuracy: 93.42916107177734, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 14. 77.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4600, train_loss: 0.035763222724199295, train_accuracy: 99.01294708251953, val_loss: 0.30580031871795654, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4700, train_loss: 0.02961520105600357, train_accuracy: 99.26374816894531, val_loss: 0.2656368911266327, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4800, train_loss: 0.031233949586749077, train_accuracy: 99.10877227783203, val_loss: 0.33454984426498413, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 4900, train_loss: 0.029996095225214958, train_accuracy: 99.1909408569336, val_loss: 0.31916844844818115, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5000, train_loss: 0.029274096712470055, train_accuracy: 99.1868896484375, val_loss: 0.3036687672138214, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5100, train_loss: 0.026089094579219818, train_accuracy: 99.31132507324219, val_loss: 0.33030906319618225, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5200, train_loss: 0.028346288949251175, train_accuracy: 99.22734832763672, val_loss: 0.30449023842811584, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5300, train_loss: 0.02469193935394287, train_accuracy: 99.34465789794922, val_loss: 0.3255338668823242, val_accuracy: 93.22382354736328, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 15. 76.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5400, train_loss: 0.02803020551800728, train_accuracy: 99.23030090332031, val_loss: 0.3195814788341522, val_accuracy: 94.2505111694336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5500, train_loss: 0.027238672599196434, train_accuracy: 99.22734832763672, val_loss: 0.31073158979415894, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5600, train_loss: 0.02129936031997204, train_accuracy: 99.4417495727539, val_loss: 0.3317825198173523, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5700, train_loss: 0.02404613234102726, train_accuracy: 99.33563232421875, val_loss: 0.3033112585544586, val_accuracy: 94.2505111694336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5800, train_loss: 0.027605846524238586, train_accuracy: 99.20307159423828, val_loss: 0.2843013107776642, val_accuracy: 93.22382354736328, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 72. 16.  0.]
 [ 0.  0.  0. 16. 75.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 5900, train_loss: 0.021803492680191994, train_accuracy: 99.44579315185547, val_loss: 0.34453284740448, val_accuracy: 94.2505111694336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6000, train_loss: 0.02029854618012905, train_accuracy: 99.48957061767578, val_loss: 0.2820502519607544, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6100, train_loss: 0.021353766322135925, train_accuracy: 99.46601867675781, val_loss: 0.3161080777645111, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6200, train_loss: 0.021162424236536026, train_accuracy: 99.3365707397461, val_loss: 0.3489910960197449, val_accuracy: 92.60780334472656, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  7.  0.  0.  0. 92.]]
Step 6300, train_loss: 0.019909830763936043, train_accuracy: 99.44905853271484, val_loss: 0.32538262009620667, val_accuracy: 94.2505111694336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6400, train_loss: 0.01689615100622177, train_accuracy: 99.56715393066406, val_loss: 0.3178027868270874, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6500, train_loss: 0.01774359866976738, train_accuracy: 99.51456451416016, val_loss: 0.2827901840209961, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6600, train_loss: 0.022423410788178444, train_accuracy: 99.33157348632812, val_loss: 0.3174411952495575, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6700, train_loss: 0.019990945234894753, train_accuracy: 99.36083984375, val_loss: 0.37262213230133057, val_accuracy: 93.22382354736328, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0. 14. 77.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6800, train_loss: 0.016590511426329613, train_accuracy: 99.49028778076172, val_loss: 0.3223733901977539, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 6900, train_loss: 0.014109479263424873, train_accuracy: 99.64350891113281, val_loss: 0.2958246171474457, val_accuracy: 94.2505111694336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7000, train_loss: 0.019620731472969055, train_accuracy: 99.38916015625, val_loss: 0.364789754152298, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7100, train_loss: 0.01594018191099167, train_accuracy: 99.5873794555664, val_loss: 0.3812912404537201, val_accuracy: 93.83983612060547, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 12. 79.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7200, train_loss: 0.017375880852341652, train_accuracy: 99.4814682006836, val_loss: 0.3557838797569275, val_accuracy: 93.83983612060547, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7300, train_loss: 0.013126104138791561, train_accuracy: 99.63996887207031, val_loss: 0.4006924331188202, val_accuracy: 94.45584869384766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7400, train_loss: 0.014748403802514076, train_accuracy: 99.60760498046875, val_loss: 0.3084174692630768, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7500, train_loss: 0.014302581548690796, train_accuracy: 99.61109924316406, val_loss: 0.32766202092170715, val_accuracy: 93.22382354736328, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0. 13. 78.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7600, train_loss: 0.012529246509075165, train_accuracy: 99.63996887207031, val_loss: 0.3820558786392212, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7700, train_loss: 0.014520053751766682, train_accuracy: 99.5873794555664, val_loss: 0.3797207772731781, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 7800, train_loss: 0.014983344823122025, train_accuracy: 99.54627990722656, val_loss: 0.4246896505355835, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  9. 82.  0.]
 [ 0.  0.  0.  0.  2. 97.]]
Step 7900, train_loss: 0.014131947420537472, train_accuracy: 99.55097198486328, val_loss: 0.36455368995666504, val_accuracy: 94.66118621826172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 8000, train_loss: 0.013281024992465973, train_accuracy: 99.59951782226562, val_loss: 0.3948547840118408, val_accuracy: 94.2505111694336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 8100, train_loss: 0.013742742128670216, train_accuracy: 99.60704803466797, val_loss: 0.41736796498298645, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 8200, train_loss: 0.015238035470247269, train_accuracy: 99.5347900390625, val_loss: 0.38001352548599243, val_accuracy: 93.6344985961914, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 8300, train_loss: 0.010313106700778008, train_accuracy: 99.76132202148438, val_loss: 0.40278688073158264, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 8400, train_loss: 0.01185200922191143, train_accuracy: 99.63945770263672, val_loss: 0.4315522611141205, val_accuracy: 93.6344985961914, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  4.  0.  0.  0. 95.]]
Step 8500, train_loss: 0.009293616749346256, train_accuracy: 99.76132202148438, val_loss: 0.38083019852638245, val_accuracy: 93.83983612060547, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  0. 55.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  0.  0.  0. 99.]]

Finished training after 8500 steps. Best val_accuracy: 95.27720808982849, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  0. 56.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  0.  0.  0. 99.]]

------------ Starting evaluation ------------
restore checkpoint: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-16-38-19-960375/ckpts/train/ckpt-4

------ Evaluation statistics
Confusion matrix: 
[[174.   0.   0.   0.   0.   0.]
 [  0. 122.   0.   0.   0.   0.]
 [  0.   0. 109.   0.   0.   0.]
 [  0.   0.   0. 153.  30.   0.]
 [  0.   0.   0.   3. 190.   0.]
 [  0.   1.   1.   0.   0. 200.]]
Precision: [1.        0.9918699 0.9909091 0.9807692 0.8636364 1.       ], Sensitivity: [1.         1.         1.         0.8360656  0.98445594 0.990099  ], F1: [1.        0.9959184 0.9954338 0.9026549 0.9200969 0.9950249]
