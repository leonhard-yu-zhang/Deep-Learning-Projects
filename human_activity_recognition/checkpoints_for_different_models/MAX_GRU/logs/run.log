------------ run folder /home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170 ------------
------------ Preparing dataset hapt... -----------
Model: "sequence_GRU_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 250, 6)]          0         
                                                                 
 gru (GRU)                   (None, 250, 256)          202752    
                                                                 
 batch_normalization (BatchN  (None, 250, 256)         1024      
 ormalization)                                                   
                                                                 
 activation (Activation)     (None, 250, 256)          0         
                                                                 
 dense (Dense)               (None, 250, 128)          32896     
                                                                 
 batch_normalization_1 (Batc  (None, 250, 128)         512       
 hNormalization)                                                 
                                                                 
 activation_1 (Activation)   (None, 250, 128)          0         
                                                                 
 dropout (Dropout)           (None, 250, 128)          0         
                                                                 
 gru_1 (GRU)                 (None, 250, 128)          99072     
                                                                 
 batch_normalization_2 (Batc  (None, 250, 128)         512       
 hNormalization)                                                 
                                                                 
 activation_2 (Activation)   (None, 250, 128)          0         
                                                                 
 dense_1 (Dense)             (None, 250, 64)           8256      
                                                                 
 batch_normalization_3 (Batc  (None, 250, 64)          256       
 hNormalization)                                                 
                                                                 
 activation_3 (Activation)   (None, 250, 64)           0         
                                                                 
 dropout_1 (Dropout)         (None, 250, 64)           0         
                                                                 
 gru_2 (GRU)                 (None, 250, 64)           24960     
                                                                 
 batch_normalization_4 (Batc  (None, 250, 64)          256       
 hNormalization)                                                 
                                                                 
 activation_4 (Activation)   (None, 250, 64)           0         
                                                                 
 global_max_pooling1d (Globa  (None, 64)               0         
 lMaxPooling1D)                                                  
                                                                 
 dense_2 (Dense)             (None, 32)                2080      
                                                                 
 batch_normalization_5 (Batc  (None, 32)               128       
 hNormalization)                                                 
                                                                 
 activation_5 (Activation)   (None, 32)                0         
                                                                 
 dropout_2 (Dropout)         (None, 32)                0         
                                                                 
 dense_3 (Dense)             (None, 6)                 198       
                                                                 
=================================================================
Total params: 372,902
Trainable params: 371,558
Non-trainable params: 1,344
_________________________________________________________________
------------ Train and evaluate ------------

------------ Starting training ----------
initializing from scratch.

Step 100, train_loss: 1.0881935358047485, train_accuracy: 60.11731719970703, val_loss: 1.6618397235870361, val_accuracy: 22.381929397583008, confusion_matrix:
[[ 0. 86.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 8.  6. 43.  0.  0.  0.]
 [ 0. 85.  0.  0.  0.  3.]
 [ 0. 90.  1.  0.  0.  0.]
 [ 0.  0. 99.  0.  0.  0.]]
Saved better checkpoint for step 100: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-1.
Step 200, train_loss: 0.6940884590148926, train_accuracy: 78.24029541015625, val_loss: 1.3380439281463623, val_accuracy: 49.281314849853516, confusion_matrix:
[[64. 22.  0.  0.  0.  0.]
 [ 1. 65.  0.  0.  0.  0.]
 [22.  1. 34.  0.  0.  0.]
 [ 0. 56.  0.  1.  0. 31.]
 [ 0. 90.  1.  0.  0.  0.]
 [ 0.  0. 23.  0.  0. 76.]]
Saved better checkpoint for step 200: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-2.
Step 300, train_loss: 0.5286771059036255, train_accuracy: 85.56208038330078, val_loss: 0.9823782444000244, val_accuracy: 67.96714782714844, confusion_matrix:
[[83.  3.  0.  0.  0.  0.]
 [ 2. 64.  0.  0.  0.  0.]
 [20.  0. 37.  0.  0.  0.]
 [ 0. 32.  0. 46.  0. 10.]
 [ 0. 74.  1.  9.  7.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Saved better checkpoint for step 300: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-3.
Step 400, train_loss: 0.4290089011192322, train_accuracy: 89.7330093383789, val_loss: 0.765185534954071, val_accuracy: 74.33264923095703, confusion_matrix:
[[85.  1.  0.  0.  0.  0.]
 [ 2. 64.  0.  0.  0.  0.]
 [15.  0. 42.  0.  0.  0.]
 [ 0. 17.  0. 63.  0.  8.]
 [ 0. 53.  1. 21. 16.  0.]
 [ 0.  0.  7.  0.  0. 92.]]
Saved better checkpoint for step 400: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-4.
Step 500, train_loss: 0.35876205563545227, train_accuracy: 91.99029541015625, val_loss: 0.5739113092422485, val_accuracy: 80.2874755859375, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 2. 64.  0.  0.  0.  0.]
 [ 8.  0. 49.  0.  0.  0.]
 [ 0. 17.  0. 65.  0.  6.]
 [ 0. 35.  1. 22. 33.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Saved better checkpoint for step 500: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-5.
Step 600, train_loss: 0.3051266372203827, train_accuracy: 93.40895080566406, val_loss: 0.4663349390029907, val_accuracy: 86.44763946533203, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 1. 65.  0.  0.  0.  0.]
 [13.  0. 44.  0.  0.  0.]
 [ 0. 11.  0. 64.  7.  6.]
 [ 0. 10.  0. 18. 63.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 600: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-6.
Step 700, train_loss: 0.26681503653526306, train_accuracy: 94.30016326904297, val_loss: 0.4180293083190918, val_accuracy: 87.885009765625, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 2. 64.  0.  0.  0.  0.]
 [12.  0. 45.  0.  0.  0.]
 [ 0.  4.  0. 63. 15.  6.]
 [ 0.  1.  0. 19. 71.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 700: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-7.
Step 800, train_loss: 0.23520271480083466, train_accuracy: 94.81391143798828, val_loss: 0.3971620798110962, val_accuracy: 90.14373779296875, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 6.  0. 51.  0.  0.  0.]
 [ 0.  4.  0. 69. 15.  0.]
 [ 0.  0.  0. 23. 68.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 800: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-8.
Step 900, train_loss: 0.21326175332069397, train_accuracy: 95.41826629638672, val_loss: 0.35862940549850464, val_accuracy: 90.34907531738281, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 1. 65.  0.  0.  0.  0.]
 [ 4.  1. 52.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  1.  0. 15. 75.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 900: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-9.
Step 1000, train_loss: 0.1912902593612671, train_accuracy: 95.63916015625, val_loss: 0.3333776295185089, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 13. 78.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 1000: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-10.
Step 1100, train_loss: 0.17998231947422028, train_accuracy: 95.82119750976562, val_loss: 0.3725150525569916, val_accuracy: 90.75975036621094, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  3. 50.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 13. 78.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1200, train_loss: 0.16561727225780487, train_accuracy: 96.17176818847656, val_loss: 0.3620315194129944, val_accuracy: 90.34907531738281, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  3. 50.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 15. 76.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1300, train_loss: 0.15317478775978088, train_accuracy: 96.33495330810547, val_loss: 0.37648141384124756, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  3. 53.  0.  0.  0.]
 [ 0.  0.  0. 62. 26.  0.]
 [ 0.  0.  0. 12. 79.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1400, train_loss: 0.14802174270153046, train_accuracy: 96.31068420410156, val_loss: 0.3679691553115845, val_accuracy: 90.96509552001953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 62. 26.  0.]
 [ 0.  0.  0. 14. 77.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1500, train_loss: 0.13905802369117737, train_accuracy: 96.6011734008789, val_loss: 0.3711627125740051, val_accuracy: 90.75975036621094, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  3. 52.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 15. 76.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1600, train_loss: 0.12964268028736115, train_accuracy: 96.78802490234375, val_loss: 0.3497816324234009, val_accuracy: 91.78645324707031, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  3. 53.  0.  0.  0.]
 [ 0.  0.  0. 62. 26.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Saved better checkpoint for step 1600: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-11.
Step 1700, train_loss: 0.12129804491996765, train_accuracy: 97.07929229736328, val_loss: 0.34465301036834717, val_accuracy: 92.4024658203125, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 67. 21.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  1.  0.  0. 98.]]
Saved better checkpoint for step 1700: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-12.
Step 1800, train_loss: 0.11983754485845566, train_accuracy: 97.07109069824219, val_loss: 0.34001415967941284, val_accuracy: 91.78645324707031, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  2. 51.  0.  0.  0.]
 [ 0.  0.  0. 64. 24.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 1900, train_loss: 0.1095905676484108, train_accuracy: 97.18446350097656, val_loss: 0.3568548858165741, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 6.  1. 50.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  0.  0.  0. 99.]]
Step 2000, train_loss: 0.10613619536161423, train_accuracy: 97.22492218017578, val_loss: 0.3572068214416504, val_accuracy: 90.75975036621094, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 12. 79.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 2100, train_loss: 0.10273974388837814, train_accuracy: 97.39517974853516, val_loss: 0.35959678888320923, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  3. 51.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  1.  0.  0. 98.]]
Step 2200, train_loss: 0.0954168513417244, train_accuracy: 97.52022552490234, val_loss: 0.353433221578598, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  2. 51.  0.  0.  0.]
 [ 0.  0.  0. 66. 22.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  2.  0.  0. 97.]]
Step 2300, train_loss: 0.09349703043699265, train_accuracy: 97.63754272460938, val_loss: 0.3527684807777405, val_accuracy: 91.78645324707031, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 63. 25.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 2400, train_loss: 0.08668767660856247, train_accuracy: 97.81648254394531, val_loss: 0.36480435729026794, val_accuracy: 91.37577056884766, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 8.  1. 48.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 2500, train_loss: 0.08120781183242798, train_accuracy: 98.05015563964844, val_loss: 0.3410947918891907, val_accuracy: 91.1704330444336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  2. 51.  0.  0.  0.]
 [ 0.  0.  0. 61. 27.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  4.  1.  0.  0. 94.]]
Step 2600, train_loss: 0.07852139323949814, train_accuracy: 98.07847595214844, val_loss: 0.3517448306083679, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 7.  1. 49.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  2.  3.  0.  0. 94.]]
Step 2700, train_loss: 0.07497994601726532, train_accuracy: 98.16487884521484, val_loss: 0.34038031101226807, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 9.  1. 47.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0. 11. 80.  0.]
 [ 0.  0.  2.  0.  0. 97.]]
Step 2800, train_loss: 0.0705776959657669, train_accuracy: 98.38996887207031, val_loss: 0.3477121889591217, val_accuracy: 93.42916107177734, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 5.  2. 50.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  4. 87.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Saved better checkpoint for step 2800: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-13.
Step 2900, train_loss: 0.06708447635173798, train_accuracy: 98.44660186767578, val_loss: 0.3198767304420471, val_accuracy: 93.01847839355469, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  3.  3.  0.  0. 93.]]
Step 3000, train_loss: 0.06325334310531616, train_accuracy: 98.56593322753906, val_loss: 0.34693726897239685, val_accuracy: 93.01847839355469, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  2. 51.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 3100, train_loss: 0.06129380315542221, train_accuracy: 98.62459564208984, val_loss: 0.330830454826355, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  2. 51.  0.  0.  0.]
 [ 0.  0.  0. 71. 17.  0.]
 [ 0.  0.  0. 12. 79.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 3200, train_loss: 0.05962058901786804, train_accuracy: 98.65290832519531, val_loss: 0.3638826608657837, val_accuracy: 93.83983612060547, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Saved better checkpoint for step 3200: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-14.
Step 3300, train_loss: 0.05626939609646797, train_accuracy: 98.67935943603516, val_loss: 0.34206879138946533, val_accuracy: 91.99179077148438, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0. 10.  0.  0. 89.]]
Step 3400, train_loss: 0.055363088846206665, train_accuracy: 98.7257308959961, val_loss: 0.3528413474559784, val_accuracy: 92.4024658203125, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 7.  2. 48.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  1.  3.  0.  0. 95.]]
Step 3500, train_loss: 0.05284830555319786, train_accuracy: 98.7742691040039, val_loss: 0.3286912143230438, val_accuracy: 92.4024658203125, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 5.  2. 50.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 3600, train_loss: 0.04781554266810417, train_accuracy: 98.94268035888672, val_loss: 0.3533385992050171, val_accuracy: 93.22382354736328, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 3700, train_loss: 0.04740799590945244, train_accuracy: 98.84708404541016, val_loss: 0.36023420095443726, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  2. 51.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0. 10. 81.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 3800, train_loss: 0.0455431304872036, train_accuracy: 98.94417572021484, val_loss: 0.356198251247406, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Saved better checkpoint for step 3800: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-15.
Step 3900, train_loss: 0.043654974550008774, train_accuracy: 98.97508239746094, val_loss: 0.34066471457481384, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 8.  2. 47.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 4000, train_loss: 0.04346795380115509, train_accuracy: 98.97249603271484, val_loss: 0.3290873169898987, val_accuracy: 92.60780334472656, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 7.  2. 48.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 4100, train_loss: 0.0402132123708725, train_accuracy: 99.14239501953125, val_loss: 0.34359198808670044, val_accuracy: 93.22382354736328, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 4200, train_loss: 0.04166682809591293, train_accuracy: 98.95887756347656, val_loss: 0.3656173646450043, val_accuracy: 93.42916107177734, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 4300, train_loss: 0.037854503840208054, train_accuracy: 99.19498443603516, val_loss: 0.34912949800491333, val_accuracy: 93.6344985961914, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  2. 54.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 4400, train_loss: 0.03564634174108505, train_accuracy: 99.20307159423828, val_loss: 0.3413170874118805, val_accuracy: 93.01847839355469, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  2. 54.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 4500, train_loss: 0.03626248985528946, train_accuracy: 99.19384002685547, val_loss: 0.3421310782432556, val_accuracy: 93.42916107177734, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 2.  2. 53.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 4600, train_loss: 0.035808127373456955, train_accuracy: 99.1868896484375, val_loss: 0.322878360748291, val_accuracy: 92.60780334472656, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  2. 51.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  6.  0.  0. 93.]]
Step 4700, train_loss: 0.031905680894851685, train_accuracy: 99.22734832763672, val_loss: 0.3211959898471832, val_accuracy: 92.4024658203125, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 6.  2. 49.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 4800, train_loss: 0.03105158731341362, train_accuracy: 99.27891540527344, val_loss: 0.3522108197212219, val_accuracy: 91.1704330444336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [12.  2. 43.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  4.  0.  0. 95.]]
Step 4900, train_loss: 0.029583588242530823, train_accuracy: 99.3648910522461, val_loss: 0.3456670343875885, val_accuracy: 91.99179077148438, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 6.  2. 49.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 5000, train_loss: 0.02776145748794079, train_accuracy: 99.36083984375, val_loss: 0.3679843246936798, val_accuracy: 93.01847839355469, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  2. 54.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  4.  0.  0. 95.]]
Step 5100, train_loss: 0.027948934584856033, train_accuracy: 99.44500732421875, val_loss: 0.36745166778564453, val_accuracy: 92.81314086914062, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  1. 52.  0.  0.  0.]
 [ 0.  0.  0. 66. 22.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 5200, train_loss: 0.02704818733036518, train_accuracy: 99.3851089477539, val_loss: 0.36784622073173523, val_accuracy: 91.99179077148438, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 65. 23.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 5300, train_loss: 0.02564471773803234, train_accuracy: 99.40129852294922, val_loss: 0.35826319456100464, val_accuracy: 92.81314086914062, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 5400, train_loss: 0.02593373693525791, train_accuracy: 99.38423919677734, val_loss: 0.37826839089393616, val_accuracy: 94.04517364501953, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 1.  2. 54.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  4.  0.  0. 95.]]
Step 5500, train_loss: 0.024989714846014977, train_accuracy: 99.46197509765625, val_loss: 0.37469106912612915, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 5.  2. 50.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  4.  0.  0. 95.]]
Step 5600, train_loss: 0.022486688569188118, train_accuracy: 99.52669525146484, val_loss: 0.3720144033432007, val_accuracy: 93.01847839355469, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 5.  0. 52.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 5700, train_loss: 0.021352941170334816, train_accuracy: 99.52198028564453, val_loss: 0.3848235011100769, val_accuracy: 92.60780334472656, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 5.  2. 50.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  3.  0.  0. 96.]]
Step 5800, train_loss: 0.021175649017095566, train_accuracy: 99.51456451416016, val_loss: 0.38642871379852295, val_accuracy: 91.99179077148438, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [10.  0. 47.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  2.  0.  0. 97.]]
Step 5900, train_loss: 0.02024907059967518, train_accuracy: 99.5064697265625, val_loss: 0.3644731938838959, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  0. 53.  0.  0.  0.]
 [ 0.  0.  0. 67. 21.  0.]
 [ 0.  0.  0.  8. 83.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 6000, train_loss: 0.02109386771917343, train_accuracy: 99.50576782226562, val_loss: 0.3574819564819336, val_accuracy: 92.4024658203125, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 6.  1. 50.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  6.  0.  0. 93.]]
Step 6100, train_loss: 0.020556259900331497, train_accuracy: 99.49028778076172, val_loss: 0.42283883690834045, val_accuracy: 90.55441284179688, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [12.  0. 45.  0.  0.  0.]
 [ 0.  0.  0. 67. 21.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  7.  0.  0. 92.]]
Step 6200, train_loss: 0.01866815984249115, train_accuracy: 99.58333587646484, val_loss: 0.3921205401420593, val_accuracy: 91.99179077148438, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 6.  0. 51.  0.  0.  0.]
 [ 0.  0.  0. 65. 23.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  7.  0.  0. 92.]]
Step 6300, train_loss: 0.021087825298309326, train_accuracy: 99.43285369873047, val_loss: 0.3600761592388153, val_accuracy: 93.42916107177734, confusion_matrix:
[[85.  1.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  1. 53.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  2.  0.  0. 97.]]
Step 6400, train_loss: 0.018902292475104332, train_accuracy: 99.53883361816406, val_loss: 0.3576902151107788, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 7.  0. 50.  0.  0.  0.]
 [ 0.  0.  0. 67. 21.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  7.  0.  0. 92.]]
Step 6500, train_loss: 0.01722170226275921, train_accuracy: 99.61974334716797, val_loss: 0.2936570942401886, val_accuracy: 92.81314086914062, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 7.  0. 50.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  4. 87.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 6600, train_loss: 0.015970516949892044, train_accuracy: 99.6556625366211, val_loss: 0.382700651884079, val_accuracy: 91.99179077148438, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 8.  0. 49.  0.  0.  0.]
 [ 0.  0.  0. 64. 24.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  4.  0.  0. 95.]]
Step 6700, train_loss: 0.017375387251377106, train_accuracy: 99.53074645996094, val_loss: 0.3681076467037201, val_accuracy: 92.19712829589844, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 9.  0. 48.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  7.  0.  0. 92.]]
Step 6800, train_loss: 0.015490754507482052, train_accuracy: 99.66423797607422, val_loss: 0.34715041518211365, val_accuracy: 92.60780334472656, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  0. 53.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  8.  0.  0. 91.]]
Step 6900, train_loss: 0.015540024265646935, train_accuracy: 99.651611328125, val_loss: 0.370797723531723, val_accuracy: 93.22382354736328, confusion_matrix:
[[85.  1.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  0. 53.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 7000, train_loss: 0.014705861918628216, train_accuracy: 99.64805603027344, val_loss: 0.32940635085105896, val_accuracy: 93.42916107177734, confusion_matrix:
[[85.  1.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 4.  0. 53.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  4. 87.  0.]
 [ 0.  0.  5.  0.  0. 94.]]
Step 7100, train_loss: 0.013864248059689999, train_accuracy: 99.67233276367188, val_loss: 0.3768497109413147, val_accuracy: 91.99179077148438, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 9.  0. 48.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  4. 87.  0.]
 [ 0.  0.  7.  0.  0. 92.]]
Step 7200, train_loss: 0.01264099683612585, train_accuracy: 99.73668670654297, val_loss: 0.3896109461784363, val_accuracy: 91.58110809326172, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 9.  0. 48.  0.  0.  0.]
 [ 0.  0.  0. 68. 20.  0.]
 [ 0.  0.  0.  5. 86.  0.]
 [ 0.  0.  7.  0.  0. 92.]]
Step 7300, train_loss: 0.013405724428594112, train_accuracy: 99.69660186767578, val_loss: 0.4000476002693176, val_accuracy: 92.4024658203125, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [10.  0. 47.  0.  0.  0.]
 [ 0.  0.  0. 69. 19.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  2.  0.  0. 97.]]
Step 7400, train_loss: 0.0132134472951293, train_accuracy: 99.68446350097656, val_loss: 0.39978885650634766, val_accuracy: 90.96509552001953, confusion_matrix:
[[85.  1.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [16.  0. 41.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  7. 84.  0.]
 [ 0.  0.  2.  0.  0. 97.]]
Step 7500, train_loss: 0.01245077233761549, train_accuracy: 99.71642303466797, val_loss: 0.4290367066860199, val_accuracy: 91.1704330444336, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [13.  0. 44.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  6. 85.  0.]
 [ 0.  0.  6.  0.  0. 93.]]

Finished training after 7500 steps. Best val_accuracy: 94.04517412185669, confusion_matrix:
[[86.  0.  0.  0.  0.  0.]
 [ 0. 66.  0.  0.  0.  0.]
 [ 3.  2. 52.  0.  0.  0.]
 [ 0.  0.  0. 70. 18.  0.]
 [ 0.  0.  0.  3. 88.  0.]
 [ 0.  0.  3.  0.  0. 96.]]

------------ Starting evaluation ------------
restore checkpoint: 
/home/RUS_CIP/st175322/dl-lab-21w-team14/experiments/run_2022-01-21-17-01-02-293170/ckpts/train/ckpt-15

------ Evaluation statistics
Confusion matrix: 
[[172.   2.   0.   0.   0.   0.]
 [  0. 122.   0.   0.   0.   0.]
 [  5.   0. 104.   0.   0.   0.]
 [  0.   0.   0. 174.   9.   0.]
 [  0.   0.   0.   0. 193.   0.]
 [  0.   0.   0.   0.   0. 202.]]
Precision: [0.9717514 0.983871  1.        1.        0.9554455 1.       ], Sensitivity: [0.9885057  1.         0.95412844 0.9508197  1.         1.        ], F1: [0.980057   0.9918699  0.9765258  0.97478986 0.9772152  1.        ]
